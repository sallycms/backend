var sly=sly||{};(function(a,b,c,d){var e=[],f="sly-csrf-token";b.Popup=function(a,b,d,f,g,h,i){var j=navigator.userAgent;a+=(new Date).getTime(),this.name=a,this.url=b,this.obj=c.open(b,a,"width="+g+",height="+h+i),-1===j.indexOf("Chrome/18.")&&-1===j.indexOf("Chrome/20.")&&(this.obj.moveTo(d,f),this.obj.focus()),e[a]=this,this.close=function(){this.obj.close()},this.setGlobal=function(a,b){this.obj[a]=b}},b.closeAllPopups=function(){for(var a in e)e.hasOwnProperty(a)&&e[a].close()},b.openCenteredPopup=function(a,c,e,f,g){0===e&&(e=550),0===f&&(f=400),g===d&&(g=",scrollbars=yes,toolbar=no,status=yes,resizable=yes");var h=parseInt((screen.width-e)/2,10),i=parseInt((screen.height-f)/2,10)-24;return new b.Popup(a,c,h,i,e,f,g)},b.openMediapool=function(c,d,e,f,g){var h="index.php?page=mediapool";return d?h+="_detail&file_name="+d:c&&("detail"!==c||d)&&(h+="_"+c),e&&(h+="&callback="+e),a.isArray(f)&&f.length>0&&(h+="&args[types]="+f.join("|")),a.isArray(g)&&g.length>0&&(h+="&args[categories]="+g.join("|")),b.openCenteredPopup("slymediapool",h,760,600)},b.openLinkmap=function(c,d,e,f){var g="index.php?page=linkmap";return c&&(g+="&category_id="+c),d&&(g+="&callback="+d),a.isArray(e)&&e.length>0&&(g+="&args[types]="+e.join("|")),a.isArray(f)&&f.length>0&&(g+="&args[categories]="+f.join("|")),b.openCenteredPopup("slylinkmap",g,760,600)},b.inherit=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c};var g=function(a){return a+(new Date).getTime()},h=function(a,b){for(var c=((a.data(b)||"")+"").split("|"),d=c.length,e=0,f=[];d>e;++e)c[e].length>0&&f.push(c[e]);return f};b.AbstractWidget=function(b){this.element=a(b),this.valueInput=this.element.find("input.value"),this.nameInput=this.element.find("input.name");var c=this.element.find(".sly-icons");c.delegate("a.fct-open","click",a.proxy(this.onOpen,this)),c.delegate("a.fct-add","click",a.proxy(this.onAdd,this)),c.delegate("a.fct-delete","click",a.proxy(this.onDelete,this))},b.AbstractWidget.prototype={getValue:function(){return this.valueInput.val()},setValue:function(a,b){return this.valueInput.val(a),this.nameInput.val(b),this.valueInput.change(),!0},clear:function(){this.setValue("","")},onOpen:function(){return!1},onAdd:function(){return!1},onDelete:function(){return this.clear(),!1}},b.MediaWidget=function(a){b.AbstractWidget.call(this,a),this.filetypes=h(this.element,"filetypes"),this.categories=h(this.element,"categories")},b.inherit(b.MediaWidget,b.AbstractWidget),b.MediaWidget.prototype.onOpen=function(){var d=g("slymediawidget");return b.openMediapool("detail",this.getValue(),d,this.filetypes,this.categories),c[d]=a.proxy(this.setValue,this),!1},b.MediaWidget.prototype.onAdd=function(){var d=g("slymediawidget");return b.openMediapool("upload","",d,this.filetypes,this.categories),c[d]=a.proxy(this.setValue,this),!1},b.LinkWidget=function(a){b.AbstractWidget.call(this,a),this.articletypes=h(this.element,"articletypes"),this.categories=h(this.element,"categories")},b.inherit(b.LinkWidget,b.AbstractWidget),b.LinkWidget.prototype.onOpen=function(){var d=this.element.data("catid"),e=g("slylinkwidget");return b.openLinkmap(d,e,this.articletypes,this.categories),c[e]=a.proxy(this.setValue,this),!1},b.AbstractListWidget=function(b){this.element=a(b),this.input=this.element.find("input[type=hidden]"),this.list=this.element.find("select"),this.min=this.element.data("min")||0,this.max=this.element.data("max")||-1;var c=this.element.find(".sly-icons.move");c.delegate("a","click",a.proxy(this.onMove,this)),c=this.element.find(".sly-icons.edit"),c.delegate("a.fct-open","click",a.proxy(this.onOpen,this)),c.delegate("a.fct-add","click",a.proxy(this.onAdd,this)),c.delegate("a.fct-delete","click",a.proxy(this.onDelete,this))},b.AbstractListWidget.prototype={getElements:function(){for(var a=this.list.find("option"),b=[],c=0,d=a.length;d>c;++c)b.push(a[c].value);return b},getCount:function(){return this.list.find("option").length},getSelected:function(){var a=this.list.find("option:selected");return a.length?a.val():null},clear:function(){this.list.find("option").remove(),this.input.val("").change()},addValue:function(b,c){var d=this.getCount(),e=this.max;if(d===e)return!0;this.list.append(a("<option>").val(b).text(c)),this.createList();var f=d+1===e;return f&&this.element.addClass("at-max"),this.element.toggleClass("at-min",this.min>=d+1),f},onDelete:function(){var a=this.list.find("option:selected");if(0===a.length)return!1;var b=this.getCount()-this.min;if(0===b)return!1;a=a.slice(0,b);var c=a.next();return 0===c.length&&(c=a.prev()),a.remove(),c.prop("selected",!0),this.element.removeClass("at-max").toggleClass("at-min",this.getCount()===this.min),this.createList(),!1},onMove:function(a){var b=a.target.className.replace("fct-",""),c=this.list,d=c.find("option:selected");return 0===d.length?!1:("top"===b?c.prepend(d):"up"===b?d.prev().insertAfter(d):"down"===b?d.next().insertBefore(d):"bottom"===b&&c.append(d),this.createList(),!1)},createList:function(){this.input.val(this.getElements().join(",")).change()},onOpen:function(){return!1},onAdd:function(){return!1}},b.MedialistWidget=function(a){b.AbstractListWidget.call(this,a),this.filetypes=h(this.element,"filetypes"),this.categories=h(this.element,"categories")},b.inherit(b.MedialistWidget,b.AbstractListWidget),b.MedialistWidget.prototype.onOpen=function(){if(this.getCount()===this.max)return!1;var d=g("slymedialistwidget");return b.openMediapool("detail",this.getSelected(),d,this.filetypes,this.categories),c[d]=a.proxy(this.addValue,this),!1},b.MedialistWidget.prototype.onAdd=function(){if(this.getCount()===this.max)return!1;var d=g("slymedialistwidget");return b.openMediapool("upload","",d,this.filetypes,this.categories),c[d]=a.proxy(this.addValue,this),!1},b.LinklistWidget=function(a){b.AbstractListWidget.call(this,a),this.articletypes=h(this.element,"articletypes"),this.categories=h(this.element,"categories")},b.inherit(b.LinklistWidget,b.AbstractListWidget),b.LinklistWidget.prototype.onOpen=function(){if(this.getCount()===this.max)return!1;var d=this.element.data("catid"),e=g("slylinklistwidget");return b.openLinkmap(d,e,this.articletypes,this.categories),c[e]=a.proxy(this.addValue,this),!1},b.disableLogin=function(d){var e=parseInt(d.html(),10)-1;d.html(e+""),e>0?c.setTimeout(b.disableLogin,1e3,d):(a("div.sly-message p span").html(a("#sly_login_form").data("message")),a("#sly_login_form input:not(:hidden)").prop("disabled",!1))},b.startLoginTimer=function(d){var e=a("div.sly-message p span strong");1===e.length&&(a("#sly_login_form input:not(:hidden)").prop("disabled",!0),a("#sly_login_form").data("message",d),c.setTimeout(b.disableLogin,1e3,e))},b.setModernizrCookie=function(){if("undefined"==typeof Modernizr)return!1;var c,a=Modernizr,b=JSON.parse(JSON.stringify(a));b.audio={},b.video={};for(c in a.audio)b.audio[c]=a.audio[c];for(c in a.video)b.video[c]=a.video[c];b._version=d,b._prefixes=d,b._domPrefixes=d,b._cssomPrefixes=d,document.cookie="sly_modernizr="+escape(JSON.stringify(b))},b.initWidgets=function(c){a(".sly-widget:not(.sly-initialized)",c).each(function(){var c=a(this),d=!1;c.is(".sly-link")?(new b.LinkWidget(this),d=!0):c.is(".sly-media")?(new b.MediaWidget(this),d=!0):c.is(".sly-linklist")?(new b.LinklistWidget(this),d=!0):c.is(".sly-medialist")&&(new b.MedialistWidget(this),d=!0),d&&c.addClass("sly-initialized")})},a(function(){if(b.initWidgets(),a(".sly-check-all").click(function(){var b=a(this).data("target");a("input[name='"+b+"']").prop("checked",this.checked)}),a("a.sly-delete, input.sly-button-delete").click(function(){return confirm("Sicher?")}),a("a.sly-confirm-me").click(function(){return confirm("Sicher?")}),a(".sly-table-extras-filter input[class*=filter_input_]").keyup(function(b){var c=a(this).attr("class"),d=c.match(/filter_input_([a-zA-Z0-9-_]+)/)[1],e=a("#"+d),f=b.keyCode;if(a("input."+c).val(a(this).val()),b.preventDefault(),8===f||46===f||109===f||189===f||f>=65&&90>=f||f>=48&&57>=f){var g=RegExp(a(this).val(),"i");a("tbody tr",e).each(function(){var b=a(this);a("td",b).filter(function(){return g.test(a(this).text())}).length?b.show():b.hide()})}}),a("a.sly-blank").attr("target","_blank"),a("#sly-navi-page-mediapool a").click(function(){return b.openMediapool(),!1}),a(".sly-form .sly-select-checkbox-list a").live("click",function(){var b=a(this).attr("rel"),c=a(this).closest("div").find("input");return c.prop("checked","all"===b),!1}),"undefined"!=typeof Modernizr){var d=Modernizr.inputtypes;for(var e in d)d.hasOwnProperty(e)&&d[e]&&a("input[type="+e+"]").addClass("ua-supported");Modernizr.input.autofocus||a("*[autofocus]").focus()}a.fn.rangeinput!==void 0&&(a('input[type="range"]:not(.ua-supported)').rangeinput({css:{input:"sly-range-range",slider:"sly-range-slider",progress:"sly-range-progress",handle:"sly-jqt-handle"}}),a('input[type*="date"]').slyDateTime({lngNoDateSelected:b.locale.noDateSelected,lngDeleteDate:b.locale.deleteDate,lngClickToInputDate:b.locale.clickToInputDate,lngMonths:b.locale.months.join(","),lngShortMonths:b.locale.shortMonths.join(","),lngDays:b.locale.days.join(","),lngShortDays:b.locale.shortDays.join(",")}));var g=function(b){if(a.fn.chosen!==void 0){for(var f,g,c=a("select:not(.sly-no-chosen) option",b),d=c.length,e=0;d>e;++e)g=a(c[e]),f=g.html().match(/^(&nbsp;)*/)[0].length/6,f>0&&g.addClass("sly-lvl-"+f).html(g.html().substr(6*f));a(".sly-form-select:not(.sly-no-chosen)",b).data("placeholder","Bitte ausw\u00e4hlen").chosen()}};g(a("body")),a("body").bind("rowAdded",function(a){g(a.currentTarget)}),a("body").delegate("a.sly-postlink","click",function(){var h,i,j,k,b=a(this).attr("href").split("?"),c=b[0],d=b[1]||"",e=a("<form>").attr("action",c).attr("method","post"),g=a('meta[name="'+f+'"]');a("body").append(e),d.indexOf("#")>=0&&(d=d.split("#")[0]),d=d.split("&");for(h in d)i=d[h].split("="),j=i[0],k=i[1],a("<input>").attr("type","hidden").attr("name",j).attr("value",k).appendTo(e);return g.length>0&&!a(this).is(".sly-no-csrf")&&a("<input>").attr("type","hidden").attr("name",f).attr("value",g.attr("content")).appendTo(e),a(e).submit(),!1}),a(".sly-form-row.sly-form-multilingual").each(function(){var b=a(this),c=b.is(":visible"),d=b.attr("rel"),e=c?' checked="checked"':"",f='<span class="sly-form-i18n-switch"><input type="checkbox" name="equal__'+d+'" id="equal__'+d+'" value="1"'+e+" /></span>";if(c)a("label:first",this).after(f);else{var g=b.next("div.sly-form-i18n-container");a("label:first",g).after(f)}});var h=a(".sly-form-i18n-switch input[id^=equal__]");h.length>0&&h.imgCheckbox("off.png","on.png","assets/form-i18n-switch-").next().click(function(){var b=a(this).prev("input"),c=!b[0].checked,d=b.attr("id").replace(/^equal__/,""),e=a('div[rel="'+d+'"]'),f=b.parent("span"),g=a("div.sly-form-i18n-container.c-"+d);c?(e.hide(),g.show(),a("label:first",g).after(f)):(e.show(),g.hide(),a("label:first",e).after(f))}),a(".sly-module-select").change(function(){a(this).closest("form").submit()}),a("select#rev").change(function(){a(this).closest("form").submit()}),a("#sly-system-toggle-cache").click(function(){return a("#sly-form-system-caches p").slideToggle(),!1});var i=null;a("#sly-page-addon .sly-addonlist").delegate("a:not(.sly-blank)","click",function(){var b=a(this),d=a(".sly-addonlist"),e=a(".pkg",d),g=b.closest(".pkg"),h=a('meta[name="'+f+'"]').attr("content"),j=b.attr("href"),k=decodeURI((RegExp("addon/(.+?)(\\?|$)").exec(j)||[,null])[1]),l=a(".error",d),m={page:"addon",func:k,addon:g.data("key"),json:1};m[f]=h,l.hide(),i&&c.clearTimeout(i),e.prepend('<div class="blocker"></div>'),g.addClass("working");var n=function(b){for(var c in b)if(b.hasOwnProperty(c)){var d=b[c],e=a('.pkg[data-key="'+c+'"]');e.attr("class",d.classes+" pkg"),a(".deps",e).html(d.deps)}},o=function(b){b.finished===!1?p():(n(b.stati),g.removeClass("working"),a(".blocker").remove(),b.status!==!0&&(g.after(l),a("span",l).html(b.message),l.show(),i=c.setTimeout(function(){l.slideUp()},1e4)))},p=function(){a.ajax({url:"index.php",data:m,cache:!1,dataType:"json",type:"POST",success:o})};return p(),!1}),a("body.sly-popup").unload(b.closeAllPopups)})})(jQuery,sly,window);