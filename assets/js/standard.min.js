var sly=sly||{};(function(a,b,c,d){var e=[],f="sly-csrf-token";b.Popup=function(b,d,f,g,h,i,j){b+=(new Date).getTime();if(d.substr(0,2)==="./"){var k=a("base").attr("href");k&&(d=k+(k.substr(k.length-1)==="/"?"":"/")+d.substr(2))}this.name=b,this.url=d,this.obj=c.open(d,b,"width="+h+",height="+i+j),e[b]=this,this.close=function(){this.obj.close()},this.setGlobal=function(a,b){this.obj[a]=b}},b.closeAllPopups=function(){for(var a in e)e.hasOwnProperty(a)&&e[a].close()},b.openCenteredPopup=function(a,c,e,f,g){e===0&&(e=550),f===0&&(f=400),g===d&&(g=",scrollbars=yes,toolbar=no,status=yes,resizable=yes");var h=parseInt((screen.width-e)/2,10),i=parseInt((screen.height-f)/2,10)-24;return new b.Popup(a,c,h,i,e,f,g)},b.openMediapool=function(c,d,e,f,g){var h="mediapool",i={args:{}};return d?(h+="_detail",i.file_name=d):c&&(c!=="detail"||d)&&(h+="_"+c),e&&(i.callback=e),a.isArray(f)&&f.length>0&&(i.args.types=f.join("|")),a.isArray(g)&&g.length>0&&(i.args.categories=g.join("|")),b.openCenteredPopup("slymediapool",b.getUrl(h,null,i),857,600)},b.openLinkmap=function(c,d,e,f){var g="linkmap",h={args:{}};return c&&(h.category_id=c),d&&(h.callback=d),a.isArray(e)&&e.length>0&&(h.args.types=e.join("|")),a.isArray(f)&&f.length>0&&(h.args.categories=f.join("|")),b.openCenteredPopup("slylinkmap",b.getUrl(g,null,h),760,600)},b.inherit=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c};var g=function(a){return a+(new Date).getTime()},h=function(a,b){var c=((a.data(b)||"")+"").split("|"),d=c.length,e=0,f=[];for(;e<d;++e)c[e].length>0&&f.push(c[e]);return f};b.AbstractWidget=function(b){this.element=a(b),this.valueInput=this.element.find("input.value"),this.nameInput=this.element.find("input.name");var c=this.element.find(".sly-icons");c.delegate("a.fct-open","click",a.proxy(this.onOpen,this)),c.delegate("a.fct-add","click",a.proxy(this.onAdd,this)),c.delegate("a.fct-delete","click",a.proxy(this.onDelete,this))},b.AbstractWidget.prototype={getValue:function(){return this.valueInput.val()},setValue:function(a,b){return this.valueInput.val(a),this.nameInput.val(b),this.valueInput.change(),!0},clear:function(){this.setValue("","")},onOpen:function(){return!1},onAdd:function(){return!1},onDelete:function(){return this.clear(),!1}},b.MediaWidget=function(a){b.AbstractWidget.call(this,a),this.filetypes=h(this.element,"filetypes"),this.categories=h(this.element,"categories")},b.inherit(b.MediaWidget,b.AbstractWidget),b.MediaWidget.prototype.onOpen=function(){var d=g("slymediawidget");return b.openMediapool("detail",this.getValue(),d,this.filetypes,this.categories),c[d]=a.proxy(this.setValue,this),!1},b.MediaWidget.prototype.onAdd=function(){var d=g("slymediawidget");return b.openMediapool("upload","",d,this.filetypes,this.categories),c[d]=a.proxy(this.setValue,this),!1},b.LinkWidget=function(a){b.AbstractWidget.call(this,a),this.articletypes=h(this.element,"articletypes"),this.categories=h(this.element,"categories")},b.inherit(b.LinkWidget,b.AbstractWidget),b.LinkWidget.prototype.onOpen=function(){var d=this.element.data("catid"),e=g("slylinkwidget");return b.openLinkmap(d,e,this.articletypes,this.categories),c[e]=a.proxy(this.setValue,this),!1},b.AbstractListWidget=function(b){this.element=a(b),this.input=this.element.find("input[type=hidden]"),this.list=this.element.find("select"),this.min=this.element.data("min")||0,this.max=this.element.data("max")||-1;var c=this.element.find(".sly-icons.move");c.delegate("a","click",a.proxy(this.onMove,this)),c=this.element.find(".sly-icons.edit"),c.delegate("a.fct-open","click",a.proxy(this.onOpen,this)),c.delegate("a.fct-add","click",a.proxy(this.onAdd,this)),c.delegate("a.fct-delete","click",a.proxy(this.onDelete,this))},b.AbstractListWidget.prototype={getElements:function(){var a=this.list.find("option"),b=[];for(var c=0,d=a.length;c<d;++c)b.push(a[c].value);return b},getCount:function(){return this.list.find("option").length},getSelected:function(){var a=this.list.find("option:selected");return a.length?a.val():null},clear:function(){this.list.find("option").remove(),this.input.val("").change()},addValue:function(b,c){var d=this.getCount(),e=this.max;if(d===e)return!0;this.list.append(a("<option>").val(b).text(c)),this.createList();var f=d+1===e;return f&&this.element.addClass("at-max"),this.element.toggleClass("at-min",d+1<=this.min),f},onDelete:function(){var a=this.list.find("option:selected");if(a.length===0)return!1;var b=this.getCount()-this.min;if(b===0)return!1;a=a.slice(0,b);var c=a.next();return c.length===0&&(c=a.prev()),a.remove(),c.prop("selected",!0),this.element.removeClass("at-max").toggleClass("at-min",this.getCount()===this.min),this.createList(),!1},onMove:function(a){var b=a.target.className.replace("fct-",""),c=this.list,d=c.find("option:selected");return d.length===0?!1:(b==="top"?c.prepend(d):b==="up"?d.prev().insertAfter(d):b==="down"?d.next().insertBefore(d):b==="bottom"&&c.append(d),this.createList(),!1)},createList:function(){this.input.val(this.getElements().join(",")).change()},onOpen:function(){return!1},onAdd:function(){return!1}},b.MedialistWidget=function(a){b.AbstractListWidget.call(this,a),this.filetypes=h(this.element,"filetypes"),this.categories=h(this.element,"categories")},b.inherit(b.MedialistWidget,b.AbstractListWidget),b.MedialistWidget.prototype.onOpen=function(){if(this.getCount()===this.max)return!1;var d=g("slymedialistwidget");return b.openMediapool("detail",this.getSelected(),d,this.filetypes,this.categories),c[d]=a.proxy(this.addValue,this),!1},b.MedialistWidget.prototype.onAdd=function(){if(this.getCount()===this.max)return!1;var d=g("slymedialistwidget");return b.openMediapool("upload","",d,this.filetypes,this.categories),c[d]=a.proxy(this.addValue,this),!1},b.LinklistWidget=function(a){b.AbstractListWidget.call(this,a),this.articletypes=h(this.element,"articletypes"),this.categories=h(this.element,"categories")},b.inherit(b.LinklistWidget,b.AbstractListWidget),b.LinklistWidget.prototype.onOpen=function(){if(this.getCount()===this.max)return!1;var d=this.element.data("catid"),e=g("slylinklistwidget");return b.openLinkmap(d,e,this.articletypes,this.categories),c[e]=a.proxy(this.addValue,this),!1},b.disableLogin=function(d){var e=parseInt(d.html(),10)-1;d.html(e+""),e>0?c.setTimeout(b.disableLogin,1e3,d):(a("div.sly-message p span").html(a("#sly_login_form").data("message")),a("#sly_login_form input:not(:hidden)").prop("disabled",!1))},b.startLoginTimer=function(d){var e=a("div.sly-message p span strong");e.length===1&&(a("#sly_login_form input:not(:hidden)").prop("disabled",!0),a("#sly_login_form").data("message",d),c.setTimeout(b.disableLogin,1e3,e))},b.setModernizrCookie=function(){if(typeof Modernizr=="undefined")return!1;var a=Modernizr,b=JSON.parse(JSON.stringify(a)),c;b.audio={},b.video={};for(c in a.audio)b.audio[c]=a.audio[c];for(c in a.video)b.video[c]=a.video[c];b._version=d,b._prefixes=d,b._domPrefixes=d,b._cssomPrefixes=d,document.cookie="sly_modernizr="+escape(JSON.stringify(b))},b.initWidgets=function(c){a(".sly-widget:not(.sly-initialized)",c).each(function(){var c=a(this),d=!1;c.is(".sly-link")?(new b.LinkWidget(this),d=!0):c.is(".sly-media")?(new b.MediaWidget(this),d=!0):c.is(".sly-linklist")?(new b.LinklistWidget(this),d=!0):c.is(".sly-medialist")&&(new b.MedialistWidget(this),d=!0),d&&c.addClass("sly-initialized")})},b.assetBaseUri=function(a){return"../assets/addon/"+(a?a+"/":"")},b.getUrl=function(b,c,d,e){var f="./";return c=c||"index",c=c.toLowerCase(),b=b.toLowerCase(),f+=encodeURI(b),c.length>0&&c!=="index"&&(f+="/"+encodeURI(c)),typeof d=="string"?d=d.replace(/^[?&]*(.*?)[?&]*$/,"$1"):typeof d=="object"?(d=a.param(d),typeof e=="string"&&e!=="&"&&(d=d.replace(/&/g,e))):d="",f+="?"+d,f.replace(/[?&]+$/,"")},a(function(){b.initWidgets(),a(".sly-check-all").click(function(){var b=a(this).data("target");a("input[name='"+b+"']").prop("checked",this.checked)}),a("a.sly-delete, input.sly-button-delete").click(function(){return confirm("Sicher?")}),a("a.sly-confirm-me").click(function(){return confirm("Sicher?")}),a(".sly-table-extras-filter input[class*=filter_input_]").keyup(function(b){var c=a(this).attr("class"),d=c.match(/filter_input_([a-zA-Z0-9_-]+)/)[1],e=a("#"+d),f=b.keyCode;a("input."+c).val(a(this).val()),b.preventDefault();if(f===8||f===46||f===109||f===189||f>=65&&f<=90||f>=48&&f<=57){var g=new RegExp(a(this).val(),"i");a("tbody tr",e).each(function(){var b=a(this),c=a("td",b).filter(function(){return g.test(a(this).text())});b.toggle(c.length>0)})}}),a("a.sly-blank").attr("target","_blank"),a("#sly-navi-page-mediapool a").click(function(){return b.openMediapool(),!1}),a(".sly-form .sly-select-checkbox-list a").live("click",function(){var b=a(this).attr("rel"),c=a(this).closest("div").find("input");return c.prop("checked",b==="all"),!1});if(typeof Modernizr!="undefined"){var d=Modernizr.inputtypes;for(var e in d)d.hasOwnProperty(e)&&d[e]&&a("input[type="+e+"]").addClass("ua-supported");Modernizr.input.autofocus||a("*[autofocus]").focus()}typeof a.fn.rangeinput!="undefined"&&(a('input[type="range"]:not(.ua-supported)').rangeinput({css:{input:"sly-range-range",slider:"sly-range-slider",progress:"sly-range-progress",handle:"sly-jqt-handle"}}),a('input[type*="date"]').slyDateTime({lngNoDateSelected:b.locale.noDateSelected,lngDeleteDate:b.locale.deleteDate,lngClickToInputDate:b.locale.clickToInputDate,lngMonths:b.locale.months.join(","),lngShortMonths:b.locale.shortMonths.join(","),lngDays:b.locale.days.join(","),lngShortDays:b.locale.shortDays.join(",")}));var g=function(b){if(typeof a.fn.select2!="undefined"){var c=a("select:not(.sly-no-select2):not(.sly-no-chosen) option",b),d=c.length,e=0,f,g;for(;e<d;++e)g=a(c[e]),f=g.html().match(/^(&nbsp;)*/)[0].length/6,f>0&&g.addClass("sly-lvl-"+f).html(g.html().substr(f*6));a(".sly-form-select:not(.sly-no-select2):not(.sly-no-chosen)",b).each(function(){var b=a(this);b.data("placeholder")===undefined&&b.data("placeholder","Bitte ausw√§hlen"),b.select2({width:"resolve"})})}};g(a("body")),a("body").bind("rowAdded",function(a){g(a.currentTarget)}),a("body").delegate("a.sly-postlink","click",function(){var b=a(this).attr("href").split("?"),c=b[0],d=b[1]||"",e=a("<form>").attr("action",c).attr("method","post"),g=a('meta[name="'+f+'"]'),h,i,j,k;a("body").append(e),d.indexOf("#")>=0&&(d=d.split("#")[0]),d=d.split("&");for(h in d)i=d[h].split("="),j=i[0],k=i[1],a("<input>").attr("type","hidden").attr("name",j).attr("value",k).appendTo(e);return g.length>0&&!a(this).is(".sly-no-csrf")&&a("<input>").attr("type","hidden").attr("name",f).attr("value",g.attr("content")).appendTo(e),a(e).submit(),!1}),a(".sly-form-row.sly-form-multilingual").each(function(){var b=a(this),c=b.is(":visible"),d=b.attr("rel"),e=c?' checked="checked"':"",f='<span class="sly-form-i18n-switch"><input type="checkbox" name="equal__'+d+'" id="equal__'+d+'" value="1"'+e+" /></span>";if(c)a("label:first",this).after(f);else{var g=b.next("div.sly-form-i18n-container");a("label:first",g).after(f)}});var h=a(".sly-form-i18n-switch input[id^=equal__]");h.length>0&&h.imgCheckbox("off.png","on.png","../assets/app/backend/form-i18n-switch-").next().click(function(){var b=a(this).prev("input"),c=!b[0].checked,d=b.attr("id").replace(/^equal__/,""),e=a('div[rel="'+d+'"]'),f=b.parent("span"),g=a("div.sly-form-i18n-container.c-"+d);c?(e.hide(),g.show(),a("label:first",g).after(f)):(e.show(),g.hide(),a("label:first",e).after(f))}),a(".sly-module-select").change(function(){a(this).val()&&a(this).closest("form").submit()});var i=a(".sly-navi-slots li:not(:first-child) a");if(i.length>5){var j=a('<select name="sly-slot" id="sly-slot" class="sly-form-select"></select>');for(var k=0;k<i.length;++k){var l=a(i[k]),m=l.is(".sly-active"),n=l.data("slyslot"),o=l.text(),p=a("<option></option>").text(o).val(n);m&&p.prop("selected",!0),j.append(p)}j.change(function(){var c=j.val(),d=a(".sly-content-header"),e=d.data("slyid"),f=d.data("slyclang"),g=d.data("slyrevision");return window.location=b.getUrl("content",null,{article_id:e,clang:f,revision:g,slot:c},"&"),!1}),i.parent().remove(),a(".sly-navi-slots").append(a("<li>").append(j)),g(j.parent())}a("#sly-system-toggle-cache").click(function(){return a("#sly-form-system-caches p").slideToggle(),!1});var q=null;a("#sly-page-addon .sly-addonlist").delegate("a:not(.sly-blank)","click",function(){var d=a(this),e=a(".sly-addonlist"),g=a(".pkg",e),h=d.closest(".pkg"),i=a('meta[name="'+f+'"]').attr("content"),j=d.attr("href"),k=decodeURI((RegExp("addon/(.+?)(\\?|$)").exec(j)||[,null])[1]),l=a(".error",e),m={addon:h.data("key"),json:1};m[f]=i,l.hide(),q&&c.clearTimeout(q),g.prepend('<div class="blocker"></div>'),h.addClass("working");var n=function(b){for(var c in b){if(!b.hasOwnProperty(c))continue;var d=b[c],e=a('.pkg[data-key="'+c+'"]');e.attr("class",d.classes+" pkg"),a(".deps",e).html(d.deps)}},o=function(b){b.finished===!1?p():(n(b.stati),h.removeClass("working"),a(".blocker").remove(),b.status!==!0&&(h.after(l),a("span",l).html(b.message),l.show(),q=c.setTimeout(function(){l.slideUp()},1e4)))},p=function(){a.ajax({url:b.getUrl("addon",k),data:m,cache:!1,dataType:"json",type:"POST",success:o})};return p(),!1}),a("body.sly-popup").unload(b.closeAllPopups)})})(jQuery,sly,window)