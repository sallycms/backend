var sly=sly||{};!function(t,e,i,n){var s=[],a="sly-csrf-token";e.Popup=function(t,e,n,a,o,l,r){t+=(new Date).getTime(),this.name=t,this.url=e,this.obj=i.open(e,t,"width="+o+",height="+l+r),s[t]=this,this.close=function(){this.obj.close()},this.setGlobal=function(t,e){this.obj[t]=e}},e.closeAllPopups=function(){for(var t in s)s.hasOwnProperty(t)&&s[t].close()},e.openCenteredPopup=function(t,i,s,a,o){0===s&&(s=550),0===a&&(a=400),o===n&&(o=",scrollbars=yes,toolbar=no,status=yes,resizable=yes");var l=parseInt((screen.width-s)/2,10),r=parseInt((screen.height-a)/2,10)-24;return new e.Popup(t,i,l,r,s,a,o)},e.openMediapool=function(i,n,s,a,o){var l="mediapool",r={args:{}};return n?(l+="_detail",r.file_name=n):i&&("detail"!==i||n)&&(l+="_"+i),s&&(r.callback=s),t.isArray(a)&&a.length>0&&(r.args.types=a.join("|")),t.isArray(o)&&o.length>0&&(r.args.categories=o.join("|")),e.openCenteredPopup("slymediapool",e.getUrl(l,null,r),857,600)},e.openLinkmap=function(i,n,s,a){var o="linkmap",l={args:{}};return i&&(l.category_id=i),n&&(l.callback=n),t.isArray(s)&&s.length>0&&(l.args.types=s.join("|")),t.isArray(a)&&a.length>0&&(l.args.categories=a.join("|")),e.openCenteredPopup("slylinkmap",e.getUrl(o,null,l),760,600)},e.inherit=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i};var o=function(t){return t+(new Date).getTime()},l=function(t,e){for(var i=((t.data(e)||"")+"").split("|"),n=i.length,s=0,a=[];n>s;++s)i[s].length>0&&a.push(i[s]);return a};e.AbstractWidget=function(e){this.element=t(e),this.valueInput=this.element.find("input.value"),this.nameInput=this.element.find("input.name");var i=this.element.find(".sly-icons");i.delegate("a.fct-open","click",t.proxy(this.onOpen,this)),i.delegate("a.fct-add","click",t.proxy(this.onAdd,this)),i.delegate("a.fct-delete","click",t.proxy(this.onDelete,this))},e.AbstractWidget.prototype={getValue:function(){return this.valueInput.val()},setValue:function(t,e){return this.valueInput.val(t),this.nameInput.val(e),this.valueInput.change(),!0},clear:function(){this.setValue("","")},onOpen:function(){return!1},onAdd:function(){return!1},onDelete:function(){return this.clear(),!1}},e.MediaWidget=function(t){e.AbstractWidget.call(this,t),this.filetypes=l(this.element,"filetypes"),this.categories=l(this.element,"categories")},e.inherit(e.MediaWidget,e.AbstractWidget),e.MediaWidget.prototype.onOpen=function(){var n=o("slymediawidget");return e.openMediapool("detail",this.getValue(),n,this.filetypes,this.categories),i[n]=t.proxy(this.setValue,this),!1},e.MediaWidget.prototype.onAdd=function(){var n=o("slymediawidget");return e.openMediapool("upload","",n,this.filetypes,this.categories),i[n]=t.proxy(this.setValue,this),!1},e.LinkWidget=function(t){e.AbstractWidget.call(this,t),this.articletypes=l(this.element,"articletypes"),this.categories=l(this.element,"categories")},e.inherit(e.LinkWidget,e.AbstractWidget),e.LinkWidget.prototype.onOpen=function(){var n=this.element.data("catid"),s=o("slylinkwidget");return e.openLinkmap(n,s,this.articletypes,this.categories),i[s]=t.proxy(this.setValue,this),!1},e.AbstractListWidget=function(e){this.element=t(e),this.input=this.element.find("input[type=hidden]"),this.list=this.element.find("select"),this.min=this.element.data("min")||0,this.max=this.element.data("max")||-1;var i=this.element.find(".sly-icons.move");i.delegate("a","click",t.proxy(this.onMove,this)),i=this.element.find(".sly-icons.edit"),i.delegate("a.fct-open","click",t.proxy(this.onOpen,this)),i.delegate("a.fct-add","click",t.proxy(this.onAdd,this)),i.delegate("a.fct-delete","click",t.proxy(this.onDelete,this))},e.AbstractListWidget.prototype={getElements:function(){for(var t=this.list.find("option"),e=[],i=0,n=t.length;n>i;++i)e.push(t[i].value);return e},getCount:function(){return this.list.find("option").length},getSelected:function(){var t=this.list.find("option:selected");return t.length?t.val():null},clear:function(){this.list.find("option").remove(),this.input.val("").change()},addValue:function(e,i){var n=this.getCount(),s=this.max;if(n===s)return!0;this.list.append(t("<option>").val(e).text(i)),this.createList();var a=n+1===s;return a&&this.element.addClass("at-max"),this.element.toggleClass("at-min",n+1<=this.min),a},onDelete:function(){var t=this.list.find("option:selected");if(0===t.length)return!1;var e=this.getCount()-this.min;if(0===e)return!1;t=t.slice(0,e);var i=t.next();return 0===i.length&&(i=t.prev()),t.remove(),i.prop("selected",!0),this.element.removeClass("at-max").toggleClass("at-min",this.getCount()===this.min),this.createList(),!1},onMove:function(t){var e=t.target.className.replace("fct-",""),i=this.list,n=i.find("option:selected");return 0===n.length?!1:("top"===e?i.prepend(n):"up"===e?n.prev().insertAfter(n):"down"===e?n.next().insertBefore(n):"bottom"===e&&i.append(n),this.createList(),!1)},createList:function(){this.input.val(this.getElements().join(",")).change()},onOpen:function(){return!1},onAdd:function(){return!1}},e.MedialistWidget=function(t){e.AbstractListWidget.call(this,t),this.filetypes=l(this.element,"filetypes"),this.categories=l(this.element,"categories")},e.inherit(e.MedialistWidget,e.AbstractListWidget),e.MedialistWidget.prototype.onOpen=function(){if(this.getCount()===this.max)return!1;var n=o("slymedialistwidget");return e.openMediapool("detail",this.getSelected(),n,this.filetypes,this.categories),i[n]=t.proxy(this.addValue,this),!1},e.MedialistWidget.prototype.onAdd=function(){if(this.getCount()===this.max)return!1;var n=o("slymedialistwidget");return e.openMediapool("upload","",n,this.filetypes,this.categories),i[n]=t.proxy(this.addValue,this),!1},e.LinklistWidget=function(t){e.AbstractListWidget.call(this,t),this.articletypes=l(this.element,"articletypes"),this.categories=l(this.element,"categories")},e.inherit(e.LinklistWidget,e.AbstractListWidget),e.LinklistWidget.prototype.onOpen=function(){if(this.getCount()===this.max)return!1;var n=this.element.data("catid"),s=o("slylinklistwidget");return e.openLinkmap(n,s,this.articletypes,this.categories),i[s]=t.proxy(this.addValue,this),!1},e.disableLogin=function(n){var s=parseInt(n.html(),10)-1;n.html(s+""),s>0?i.setTimeout(e.disableLogin,1e3,n):(t("div.sly-message p span").html(t("#sly_login_form").data("message")),t("#sly_login_form input:not(:hidden)").prop("disabled",!1))},e.startLoginTimer=function(n){var s=t("div.sly-message p span strong");1===s.length&&(t("#sly_login_form input:not(:hidden)").prop("disabled",!0),t("#sly_login_form").data("message",n),i.setTimeout(e.disableLogin,1e3,s))},e.setModernizrCookie=function(){if("undefined"==typeof Modernizr)return!1;var t,e=Modernizr,i=JSON.parse(JSON.stringify(e));i.audio={},i.video={};for(t in e.audio)i.audio[t]=e.audio[t];for(t in e.video)i.video[t]=e.video[t];i._version=n,i._prefixes=n,i._domPrefixes=n,i._cssomPrefixes=n,document.cookie="sly_modernizr="+escape(JSON.stringify(i))},e.initWidgets=function(i){t(".sly-widget:not(.sly-initialized)",i).each(function(){var i=t(this),n=!1;i.is(".sly-link")?(new e.LinkWidget(this),n=!0):i.is(".sly-media")?(new e.MediaWidget(this),n=!0):i.is(".sly-linklist")?(new e.LinklistWidget(this),n=!0):i.is(".sly-medialist")&&(new e.MedialistWidget(this),n=!0),n&&i.addClass("sly-initialized")})},e.assetBaseUri=function(t){return"../assets/addon/"+(t?t+"/":"")},e.getUrl=function(e,i,n,s){var a="./";return i=i||"index",i=i.toLowerCase(),e=e.toLowerCase(),a+=encodeURI(e),i.length>0&&"index"!==i&&(a+="/"+encodeURI(i)),"string"==typeof n?n=n.replace(/^[?&]*(.*?)[?&]*$/,"$1"):"object"==typeof n?(n=t.param(n),"string"==typeof s&&"&"!==s&&(n=n.replace(/&/g,s))):n="",a+="?"+n,a.replace(/[?&]+$/,"")},t(function(){if(e.initWidgets(),t(".sly-check-all").click(function(){var e=t(this).data("target");t("input[name='"+e+"']").prop("checked",this.checked)}),t("a.sly-delete, input.sly-button-delete").click(function(){return confirm("Sicher?")}),t("a.sly-confirm-me").click(function(){return confirm("Sicher?")}),t(".sly-table-extras-filter input[class*=filter_input_]").keyup(function(e){var i=t(this).attr("class"),n=i.match(/filter_input_([a-zA-Z0-9_-]+)/)[1],s=t("#"+n),a=e.keyCode;if(t("input."+i).val(t(this).val()),e.preventDefault(),8===a||46===a||109===a||189===a||a>=65&&90>=a||a>=48&&57>=a){var o=new RegExp(t(this).val(),"i");t("tbody tr",s).each(function(){var e=t(this),i=t("td",e).filter(function(){return o.test(t(this).text())});e.toggle(i.length>0)})}}),t("a.sly-blank").attr("target","_blank"),t("#sly-navi-page-mediapool a").click(function(){return e.openMediapool(),!1}),t(".sly-form .sly-select-checkbox-list a").live("click",function(){var e=t(this).attr("rel"),i=t(this).closest("div").find("input");return i.prop("checked","all"===e),!1}),"undefined"!=typeof Modernizr){var n=Modernizr.inputtypes;for(var s in n)n.hasOwnProperty(s)&&n[s]&&t("input[type="+s+"]").addClass("ua-supported");Modernizr.input.autofocus||t("*[autofocus]").focus()}"undefined"!=typeof t.fn.rangeinput&&(t('input[type="range"]:not(.ua-supported)').rangeinput({css:{input:"sly-range-range",slider:"sly-range-slider",progress:"sly-range-progress",handle:"sly-jqt-handle"}}),t('input[type*="date"]').slyDateTime({lngNoDateSelected:e.locale.noDateSelected,lngDeleteDate:e.locale.deleteDate,lngClickToInputDate:e.locale.clickToInputDate,lngMonths:e.locale.months.join(","),lngShortMonths:e.locale.shortMonths.join(","),lngDays:e.locale.days.join(","),lngShortDays:e.locale.shortDays.join(",")}));var o=function(e){if("undefined"!=typeof t.fn.chosen){for(var i,n,s=t("select:not(.sly-no-chosen) option",e),a=s.length,o=0;a>o;++o)n=t(s[o]),i=n.html().match(/^(&nbsp;)*/)[0].length/6,i>0&&n.addClass("sly-lvl-"+i).html(n.html().substr(6*i));t(".sly-form-select:not(.sly-no-chosen)",e).data("placeholder","Bitte ausw√§hlen").chosen()}};o(t("body")),t("body").bind("rowAdded",function(t){o(t.currentTarget)}),t("body").delegate("a.sly-postlink","click",function(){var e,i,n,s,o=t(this).attr("href").split("?"),l=o[0],r=o[1]||"",d=t("<form>").attr("action",l).attr("method","post"),c=t('meta[name="'+a+'"]');t("body").append(d),r.indexOf("#")>=0&&(r=r.split("#")[0]),r=r.split("&");for(e in r)i=r[e].split("="),n=i[0],s=i[1],t("<input>").attr("type","hidden").attr("name",n).attr("value",s).appendTo(d);return c.length>0&&!t(this).is(".sly-no-csrf")&&t("<input>").attr("type","hidden").attr("name",a).attr("value",c.attr("content")).appendTo(d),t(d).submit(),!1}),t(".sly-form-row.sly-form-multilingual").each(function(){var e=t(this),i=e.is(":visible"),n=e.attr("rel"),s=i?' checked="checked"':"",a='<span class="sly-form-i18n-switch"><input type="checkbox" name="equal__'+n+'" id="equal__'+n+'" value="1"'+s+" /></span>";if(i)t("label:first",this).after(a);else{var o=e.next("div.sly-form-i18n-container");t("label:first",o).after(a)}});var l=t(".sly-form-i18n-switch input[id^=equal__]");l.length>0&&l.imgCheckbox("off.png","on.png","../assets/app/backend/form-i18n-switch-").next().click(function(){var e=t(this).prev("input"),i=!e[0].checked,n=e.attr("id").replace(/^equal__/,""),s=t('div[rel="'+n+'"]'),a=e.parent("span"),o=t("div.sly-form-i18n-container.c-"+n);i?(s.hide(),o.show(),t("label:first",o).after(a)):(s.show(),o.hide(),t("label:first",s).after(a))}),t(".sly-module-select").change(function(){t(this).val()&&t(this).closest("form").submit()}),t("#sly-system-toggle-cache").click(function(){return t("#sly-form-system-caches p").slideToggle(),!1});var r=null;t("#sly-page-addon .sly-addonlist").delegate("a:not(.sly-blank)","click",function(){var n=t(this),s=t(".sly-addonlist"),o=t(".pkg",s),l=n.closest(".pkg"),d=t('meta[name="'+a+'"]').attr("content"),c=n.attr("href"),p=decodeURI((RegExp("addon/(.+?)(\\?|$)").exec(c)||[,null])[1]),h=t(".error",s),u={addon:l.data("key"),json:1};u[a]=d,h.hide(),r&&i.clearTimeout(r),o.prepend('<div class="blocker"></div>'),l.addClass("working");var f=function(e){for(var i in e)if(e.hasOwnProperty(i)){var n=e[i],s=t('.pkg[data-key="'+i+'"]');s.attr("class",n.classes+" pkg"),t(".deps",s).html(n.deps)}},g=function(e){e.finished===!1?y():(f(e.stati),l.removeClass("working"),t(".blocker").remove(),e.status!==!0&&(l.after(h),t("span",h).html(e.message),h.show(),r=i.setTimeout(function(){h.slideUp()},1e4)))},y=function(){t.ajax({url:e.getUrl("addon",p),data:u,cache:!1,dataType:"json",type:"POST",success:g})};return y(),!1}),t("body.sly-popup").unload(e.closeAllPopups)})}(jQuery,sly,window);