(function(e){"use strict";var t=e("<a />"),n=function(e){return e<10?"0"+e:e},r=function(e,r,i){var s=e.getDate(),o=e.getDay(),u=e.getMonth(),a=e.getFullYear(),f=e.getUTCHours(),l=e.getUTCMinutes(),c=e.getUTCSeconds(),h={d:s,dd:n(s),ddd:i.shortDays[o],dddd:i.days[o],m:u+1,mm:n(u+1),mmm:i.shortMonths[u],mmmm:i.months[u],yy:(a+"").slice(2),yyyy:a,H:f,HH:n(f),M:l,MM:n(l),S:c,SS:n(c)},p=r.replace(/d{1,4}|m{1,4}|yy(?:yy)?|HH?|MM?|SS?|"[^"]*"|'[^']*'/g,function(e){return e in h?h[e]:e});return t.html(p).html()},i=function(e){var t=document.createElement("input");return t.setAttribute("type",e),t.type!=="text"},s={date:"yyyy-mm-dd","datetime-local":"yyyy-mm-ddTHH:MM"},o={date:i("date"),"datetime-local":i("datetime-local")},u=function(e,t){var n=a(e),r=o[n],i=e.prop("required"),s=e.nextAll(".sly-date-disabled"),u=e.nextAll(".sly-date-delete"),f=t==="",l=r&&f;e.toggle(!l),s.toggle(l),u.toggle(!i&&!f)},a=function(t){return e(t).data("sly-orig-type")},f=function(e){return e===""?new Date:new Date(Date.parse(e))},l=function(t){return e(t).nextAll(".sly-date-iso")},c=function(){return e(e("#calroot").data("sly-curelement"))},h=function(e,t){var n=l(e),i=a(e),o=e.data("sly-labels");n.val(t===""?"":r(t,s[i],o)),e.val(t===""?"":r(t,e.data("format"),o))},p=function(){var e="",t="abcdefghijklmnopqrstuvwxyz",n=0,r=15;for(;n<r;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e};e.fn.slyDateTime=function(t){var n=e.extend({},e.fn.slyDateTime.defaults,t),r=e(this).filter('input[type*="date"]'),i={months:n.lngMonths,shortMonths:n.lngShortMonths,days:n.lngDays,shortDays:n.lngShortDays};return e.tools.dateinput.localize("slydatetime",i),r.each(function(){var t=e(this),r=t.attr("type"),s=o[r],d=t.attr("type")==="datetime-local",v=t.data("format"),m=t.prop("required"),g=t.attr("name"),y=e('<a href="#" class="sly-date-delete"></a>').attr("title",n.lngDeleteDate),b=t.val()===""?"":f(t.val()),w=e('<input type="hidden" value="" class="sly-date-iso" />'),E=e('<span class="sly-date-disabled sly-form-read"><span>('+n.lngNoDateSelected+")</span></span>"),S=p();if(m&&s)return;s?(t.after(E).after(y),t.data("sly-orig-type",r)):(t.attr("name",n.nameFrmt.replace("%s",g)),w.attr("name",g),t.after(w),m||(E.attr("title",n.lngClickToInputDate),t.after(E).after(y)),t.addClass(S),t.dateinput({format:v,selectors:!1,lang:"slydatetime",offset:[5,0],firstDay:1}),t=e("."+S),t.removeClass(S),t.data("sly-labels",i),t.data("sly-orig-type",r),h(t,b)),u(t,b),E.click(function(){u(t,"dummy")}),y.click(function(){return u(t,""),h(t,""),!1});if(!s){t.on("change",function(){var e=t.data("dateinput").getValue();h(t,e),u(t,e)}),t.on("keydown",function(e){if(e.keyCode===8||e.keyCode===46)h(t,""),u(t,"")}),t.on("onBeforeShow",function(t){var n=a(t.target)!=="date";e(".sly-date-sliders").toggle(n),e("#calweeks").toggleClass("sly-has-time",n)});if(d){t.on("onBeforeShow",function(t){var n=t.target,r=e("#calroot"),i=e(".sly-date-range:first",r).data("rangeinput"),s=e(".sly-date-range:last",r).data("rangeinput"),o=l(n).val();r.data("sly-curelement",n),o===""?(i.setValue(0),s.setValue(0)):(o=f(o),i.setValue(o.getUTCHours()),s.setValue(o.getUTCMinutes()))}),t.on("beforeChange",function(e,n){var r=l(c()).val();return r!==""&&(r=f(r),n.setHours(r.getHours()),n.setMinutes(r.getMinutes()),n.setSeconds(r.getSeconds())),h(t,n),u(t,n),t.data("dateinput").hide().show(),!1});var x=e("#calbody");if(!x.is(".sly-has-time")){x.addClass("sly-has-time");var T=e('<div class="sly-date-sliders"></div>');T.append(e('<input type="range" min="0" max="23" step="1" data-type="hours" />').attr("name",g+"__slyhours")).append(e('<input type="range" min="0" max="59" step="1" data-type="minutes" />').attr("name",g+"__slyminutes")),x.append(T),e(":range",x).rangeinput({css:{slider:"sly-date-slider",input:"sly-date-range sly-form-text",handle:"sly-jqt-handle"}}),e(".sly-date-range:first",x).prop("readonly",!0).after("h"),e(".sly-date-range:last",x).prop("readonly",!0).after("m"),e(".sly-date-range",x).change(function(t,n){var r=e("#calroot"),i=c(),s=parseInt(e(".sly-date-range:first",r).val(),10),o=parseInt(e(".sly-date-range:last",r).val(),10),a=f(l(i).val());a.setUTCHours(s),a.setUTCMinutes(o),h(i,a),u(i,a)})}}}})},e.fn.slyDateTime.defaults={lngNoDateSelected:"kein Datum angegeben",lngDeleteDate:"löschen",lngClickToInputDate:"hier klicken, um ein Datum anzugeben",nameFrmt:"input_%s",lngMonths:"Januar,Februar,März,April,Mai,Juni,Juli,August,September,Oktober,November,Dezember",lngShortMonths:"Jan,Feb,Mär,Apr,Mai,Jun,Jul,Aug,Sep,Okt,Nov,Dez",lngDays:"Sonntag,Montag,Dienstag,Mittwoch,Donnerstag,Freitag,Samstag",lngShortDays:"So,Mo,Di,Mi,Do,Fr,Sa"}})(jQuery);